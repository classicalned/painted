<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Haunted Painting – Control</title>

<!-- App install -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f0f0f">

<style>
  :root{
    --bg:#0f0f0f; --fg:#ddd; --muted:#9aa0a6; --btn:#2b2b2b; --field:#1a1a1a; --border:#333;
  }
  html,body{margin:0;background:var(--bg);color:var(--fg)}
  body{
    font:20px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    display:flex; flex-direction:column; gap:18px; padding:20px;
  }
  .row{display:flex; gap:14px; align-items:center; flex-wrap:wrap}

  /* BIG touch targets */
  button, select, input{
    font-size:22px; line-height:1.2;
    padding:16px 20px;
    min-height:60px; min-width:60px;
    border-radius:14px;
  }
  button{ background:var(--btn); color:#fff; border:0; }
  select,input{ background:var(--field); color:#fff; border:1px solid var(--border); }

  /* Labels */
  label{ font-weight:600; }

  .pill{
    padding:8px 12px;
    border-radius:999px;
    background:#1b1b1b;
    border:1px solid var(--border);
    font-size:18px;
  }

  /* Make the main controls big tiles */
  .controls{ width:100%; }
  .controls button{
    flex:1 1 240px;
    text-align:center;
  }

  .small{font-size:16px;color:var(--muted)}
</style>
</head>
<body>

<div class="row">
  <label for="room">Room</label>
  <input id="room" value="house01" />
  <button onclick="setRoom()">Use</button>
</div>

<div class="row">
  <span class="pill">Card</span>

  <select id="rank" aria-label="Rank">
    <option value="A">A</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="J">J</option>
    <option value="Q">Q</option>
    <option value="K">K</option>
  </select>

  <select id="suit" aria-label="Suit">
    <option value="H">♥ Hearts</option>
    <option value="D">♦ Diamonds</option>
    <option value="C">♣ Clubs</option>
    <option value="S">♠ Spades</option>
  </select>

  <button onclick="applyCard()">Set Card</button>
</div>

<div class="row controls">
  <button onclick="advance()">Next ➜</button>
  <button onclick="back()">◀ Back</button>
  <button onclick="reset()">⟲ Reset</button>
</div>

<div class="small">Steps: 0..5 = positions, 6 = final card frame.</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
// Firebase config (unchanged)
const firebaseConfig = {
  apiKey: "AIzaSyA-qhu_bH-GSKrWwAeUUmuxh5EbSrGgOrE",
  authDomain: "haunted-painting.firebaseapp.com",
  databaseURL: "https://haunted-painting-default-rtdb.firebaseio.com",
  projectId: "haunted-painting",
  storageBucket: "haunted-painting.firebasestorage.app",
  messagingSenderId: "543448897329",
  appId: "1:543448897329:web:548f8e73300484977ec210",
  measurementId: "G-4WTEQ9TRYD"
};

firebase.initializeApp(firebaseConfig);

// ---- control state ----
let ROOM_ID = "house01";
let ref = firebase.database().ref("rooms/"+ROOM_ID);
let step = 0;
let card = "AH"; // default

const rankSel = document.getElementById('rank');
const suitSel = document.getElementById('suit');

// defaults: AH
rankSel.value = "A";
suitSel.value = "H";

function setRoom(){
  ROOM_ID = document.getElementById('room').value.trim() || "house01";
  ref = firebase.database().ref("rooms/"+ROOM_ID);
  ref.set({step, card});
}

function sync(){ ref.set({step, card}); }
function advance(){ step = Math.min(6, step+1); sync(); }
function back(){ step = Math.max(0, step-1); sync(); }
function reset(){ step = 0; sync(); }

function applyCard(){
  const r = rankSel.value.toUpperCase();
  const s = suitSel.value.toUpperCase(); // H/D/C/S
  card = r + s;
  sync();
}

// Keyboard shortcuts (Space/Right/Left/R)
window.addEventListener('keydown', (e)=>{
  if(e.code==="Space"||e.key==="ArrowRight"){ advance(); }
  else if(e.key==="ArrowLeft"){ back(); }
  else if(e.key==="r"||e.key==="R"){ reset(); }
});

setRoom(); // initialize
</script>
</body>
</html>
