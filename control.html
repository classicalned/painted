<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Haunted Painting – Control</title>

<!-- App install -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f0f0f">

<style>
  :root{
    --bg:#0f0f0f; --fg:#ddd; --muted:#9aa0a6;
    --btn:#2b2b2b; --field:#1a1a1a; --border:#333;
    --accent:#3a7afe;
  }
  html,body{margin:0;background:var(--bg);color:var(--fg)}
  body{
    font:20px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    display:flex; flex-direction:column; gap:18px; padding:20px; max-width:720px; margin:auto;
  }
  .stack{display:flex; flex-direction:column; gap:14px}

  /* BIG touch targets */
  button, select{
    font-size:22px; line-height:1.2;
    padding:16px 20px;
    min-height:60px; min-width:60px;
    border-radius:14px;
  }
  button{ background:var(--btn); color:#fff; border:0; }
  select{ background:var(--field); color:#fff; border:1px solid var(--border); }

  /* Specific buttons */
  .reset{ background:#3b3b3b }
  .primary{ background:var(--accent); }
  .secondary{ background:#444; }

  /* Sizes */
  .w-full{ width:100% }
  .w-large{ width:100%; padding-block:22px; font-size:30px }  /* big NEXT */
  .w-med{ width:70% }                                         /* smaller BACK */

  /* Labels */
  .label{ font-weight:600; font-size:18px; color:#cfcfcf }
</style>
</head>
<body>

<!-- RESET on top -->
<button class="reset w-full" onclick="reset()">⟲ Reset</button>

<!-- Card selects -->
<div class="stack">
  <div class="label">Card</div>
  <select id="rank" aria-label="Rank">
    <option value="A">A</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
    <option value="J">J</option>
    <option value="Q">Q</option>
    <option value="K">K</option>
  </select>

  <select id="suit" aria-label="Suit">
    <option value="H">♥ Hearts</option>
    <option value="D">♦ Diamonds</option>
    <option value="C">♣ Clubs</option>
    <option value="S">♠ Spades</option>
  </select>

  <button class="w-full" onclick="applyCard()">Set Card</button>
</div>

<!-- Big NEXT, smaller BACK -->
<button class="primary w-large" onclick="advance()">Next ➜</button>
<button class="secondary w-med" onclick="back()">◀ Back</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
// Firebase config (same as before)
const firebaseConfig = {
  apiKey: "AIzaSyA-qhu_bH-GSKrWwAeUUmuxh5EbSrGgOrE",
  authDomain: "haunted-painting.firebaseapp.com",
  databaseURL: "https://haunted-painting-default-rtdb.firebaseio.com",
  projectId: "haunted-painting",
  storageBucket: "haunted-painting.firebasestorage.app",
  messagingSenderId: "543448897329",
  appId: "1:543448897329:web:548f8e73300484977ec210",
  measurementId: "G-4WTEQ9TRYD"
};

firebase.initializeApp(firebaseConfig);

// Fixed room (stripped the selector)
const ROOM_ID = "house01";
let ref = firebase.database().ref("rooms/"+ROOM_ID);

// state
let step = 0;
let card = "AH"; // default

const rankSel = document.getElementById('rank');
const suitSel = document.getElementById('suit');

// defaults: AH
rankSel.value = "A";
suitSel.value = "H";

// actions
function sync(){ ref.set({step, card}); }
function advance(){ step = Math.min(6, step+1); sync(); }
function back(){ step = Math.max(0, step-1); sync(); }
function reset(){ step = 0; sync(); }

function applyCard(){
  const r = rankSel.value.toUpperCase();
  const s = suitSel.value.toUpperCase(); // H/D/C/S
  card = r + s;
  sync();
}

// Keyboard shortcuts (Space/Right/Left/R)
window.addEventListener('keydown', (e)=>{
  if(e.code==="Space"||e.key==="ArrowRight"){ advance(); }
  else if(e.key==="ArrowLeft"){ back(); }
  else if(e.key==="r"||e.key==="R"){ reset(); }
});

// initialize
sync();
</script>
</body>
</html>
